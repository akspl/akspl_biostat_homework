---
title: "Анализ выживаемости"
author: "Алексей Зулькарнаев, Оксана Пластинина"
date: "Ноябрь 2025"
output:
  html_document:
    self_contained: true
    code_folding: hide
    code_download: false
    number_sections: false
    toc: true
    toc_float: true
    toc_title: Оглавление
    fig_align: center
    dev: png
---
# Настройка

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)

```

```{r}
library(readxl)
library(dplyr)
library(tidyverse)
library(tidyr)
library(ggplot2)
library(gtsummary)
library(survival)
library(survminer)
library(survRM2)
library(ggsurvfit)
library(muhaz)
library(biostat3)
library(rms)
library(flextable)
library(patchwork)
```

```{r}
thememine <- theme(
  plot.title = element_text(size = 15, hjust = 0.5),
  axis.title = element_text(size = 12),
  axis.text = element_text(size = 9, colour = 'grey10'),
  panel.background = element_rect(fill = 'white'),
  panel.grid = element_line(colour = 'grey90')
)

theme_set(thememine)
```

В рамках задания работа проводилас с датасетом - листом ожидания трансплантации почки.

<br>

Пациенты в результате различных заболеваний утрачивают функцию почек. Можно сказать, что это пациенты без почек (хотя по факту они у многих на месте, просто не работают). Как вы понимаете совсем без почек жить можно, но не долго. Поэтому функцию почек протезируют. Это называется "заместительная почечная терапия". Она бывает разная. Можно разделить ее на диализ и трансплантацию.  
Поскольку диализ в настоящее время хороший, пациенты могут нормально жить на нем. Но в долгосрочной перспективе трансплантация обеспечивает лучшее качество жизни и большую ее продолжительность. Поэтому это предпочтительный метод заместительной почечной терапии

<br>

Многие факторы могут быть связаны с увеличением срока ожидания. Например:
  
  - детям могут отдавать приоритет
  - пожилым пациентам могут реже выполнять трансплантацию, как за счет ухудшения коморбидного фона выполнение трансплантации (операции как таковой) может быть рискованно
  - федеральные центры могут иметь бОльший лист ожидания и при фиксированном количестве донорских почек, каждый пациент в листе ожидания может ждать оран дольше
  - пациенты с группой крови AB могут дольше ждать трансплантацию т.к. доноров с АВ группой крови так же меньше (в РФ трансплантация выполняется только "группа в группу", резус-фактор не важен)
  - и т.п.
  
# Подготовка к анализу

```{r}
data <- read_excel("DATA_homework_surv_with_diab.xlsx")
```

Преобразования исходной базы данных:

Преобразуем переменные пола, круппы крови, резус-фактора, id центра, уровень центра, статус на момент включения в лист ожидания, статус на момент окончания наблюдения и статус диабета в фактор.

Преобразуем переменные даты рождения, даты включения в лист ожидания, даты окончания наблюдения в формат даты.

Создаем пременную T_waiting, содержащую информацию о времени ожидания трансплантации в днях с момента становления на учет необходимости пересадки. Преобразуем все нулевые значения этой переменной в 0.05 дня.

Создаем переменную Status_max_numeric содержащую закодированный статус на момент окончания наблюдения, где 1 - событие (трансплантация) произошло, 0 - нет.

Удаляем из база значение Twaiting, содержащее отрицательное значение времени ожидания. Также удаляем строку со значением Age = 125, дата рождения такого пациента обозначена как 1900.01.01, что похоже просто на автоматическое заполнение перменной. Т.к. выборка большая (более 5800 наблюдейний), удаление нескольких наблюдений не повлияет на результаты анализа.

```{r}
data <-  data %>% 
  mutate(across(c(sex, Bl_gr, Rhesus, Centre, Level, Status_0, Status_max, diab), ~ as.factor(.)),
         
         BirthD = as.Date(BirthD, format = "%d.%m.%Y"),
         T0 = as.Date(T0, format = "%d.%m.%Y"),
         T_max = as.Date(T_max, format = "%d.%m.%Y"),
         
         Twaiting = as.numeric(difftime(time1 = T_max, time2 = T0, units = 'days')),
         Twaiting = case_when(Twaiting == 0 ~ 0.05,
                     TRUE ~ Twaiting),
         
         Status_max_numeric = case_when(Status_max == 'Transplantation' ~ 1,
                                        TRUE ~ 0) %>% as.factor()) %>%
  filter(Twaiting>0, age != 125)
```

  
# 1. Описание датасета

База данных представляет собой лист ожидания трансплантации почки. Содержит информацию о 5888 пациентах (после удаления некорректных наблюдений) по следующим переменным:

  - **id** - id пациента
  - **sex** - пол
  - **BirthD** - дата рождения
  - **age** - возраст в годах на момент включения в лист ожидания
  - **Bl_gr** - группа крови
  - **Rhesus** - резус-фактор
  - **Centre** - (id центра)
  - **Level** - уровень центра (локальный/федеральный)
  - **T0** - дата включения в лист ожидания
  - **Status_0** - статус на момент включения в лист ожидания
  - **Status_max** - статус на момент окончания наблюдения. 
  - **T_max** - дата окончания наблюдения
  - **diab** - статус диабета (есть/нет)
  - **Twaiting** - время наблюдения до текущего статуса
  - **Status_max_numeric** - статус на момент окончания наблюдения (1 - событие (трансплантация) произошло, 0 - иное)

В таблице ниже предсталены распредление пациентов по подгруппам признаков и их распределние относитлеьно статуса трансплантации на момент окончания наблюдения.

```{r}
data %>% 
  select_if(is.factor) %>% 
  mutate(
    Status_max_numeric = case_when(
      Status_max_numeric == 0 ~ 'No transplantation',
      Status_max_numeric == 1 ~ 'Transplantation'
    ),
    Status_max_numeric = as.factor(Status_max_numeric),
    diab = case_when(
      diab == "0" ~ 'No ',
      diab == "1" ~ 'Yes ',
      TRUE ~ diab
    ) %>% as.factor()
  ) %>% 
  tbl_summary(
    by = Status_max_numeric,
    type = all_continuous() ~ "categorical",
    statistic = all_categorical() ~ "{n} ({p}%)",
    include = everything(),
    label = list(
      Bl_gr ~ 'blood group',
      Level ~ 'centre level',
      Status_0 ~ 'initial status',
      Status_max ~ 'status at the end of monitoring',
      diab ~ 'diabetes status'
    )
    )%>% 
  add_overall() %>% 
  as_flex_table() %>% 
  theme_box() %>% 
  bg(part = "header", bg = "cornsilk") %>%
  bg(i = c(1,5,10,14,28,31,34,39), bg = "grey90", part = "body") %>%
  merge_h_range(i = c(1,5,10,14,28,31,34,39), j1 = 1, j2 = 4, part = "body") %>%
  align(part = 'all', align = 'center') %>% 
  set_table_properties(layout = 'autofit', width = 0.8)
```



Для дальнейшего анализа мы разделили пациентов на две группы: получшие на данный момент новую почку и не получившие. Мы предполагаем, что пациенты с диабетом из-за медицинских противопоказаний и сложности подбора донорного органа иммеют сниженную вероятность трансплантации. Также мы предполагаем, что вероятность транспланатции будет зависеть от географического расположения центра (локальный или федеральный) из-за разности материальных рестурсов и квалификации медицинского персонала. Поэтому, в данном анализе нас интересует вероятность трансплантации почки во времени в зависимости от наличия у пациента диабета и места его закрепления в медициенском центре (федеральном или локальном).

Распределение пациентов, получивших новую почку, в зависимости от статуса диабета и расположения медицинского центра, представлены на графике.

```{r}
transplantvalues <- c('0' = 'не проведена', '1' = 'не проведена')
diabvalues <- c('0' = 'нет диабета', '1' = 'есть диабет')
levelvalues <- c('local' = 'локальный', 'federal' = 'федеральный')

transplcolors <- c('0' = 'plum', '1' = 'moccasin')
diabcolors <- c('0' = 'seagreen', '1' = 'steelblue')
levelcolors <- c('local' = 'tomato3', 'federal' = 'azure3')

```

```{r fig.height=5, fig.width=13}
diabplot <- data %>% 
  ggplot(aes(x = diab, fill = Status_max_numeric))+
  geom_bar(position = 'dodge', colour = 'grey30')+
  scale_fill_manual(
    name = 'Трасплантация',
    values = transplcolors, 
    labels = transplantvalues
  )+
  labs(
    
    y = 'Количество пациентов',
    x = 'Статус диабета'
  )+
  scale_x_discrete(labels = diabvalues)+
  scale_y_continuous(breaks = seq(0,2500,250))+
  theme(
    legend.position = 'none',
    axis.title = element_text(size = 18),
    axis.text.x = element_text(size = 14)
  )

levelplot <- data %>% 
  ggplot(aes(x = Level, fill = Status_max_numeric))+
  geom_bar(position = 'dodge', colour = 'grey30')+
  scale_fill_manual(
    name = 'Трасплантация',
    values = transplcolors, 
    labels = transplantvalues
  )+
  labs(
    
    y = 'Количество пациентов',
    x = 'Расположение медицинского центра'
  )+
  scale_x_discrete(labels = levelvalues)+
  scale_y_continuous(breaks = seq(0,2500,250))+
  theme(
    axis.title.y = element_blank(),
    axis.title = element_text(size = 18),
    axis.text.x = element_text(size = 14),
    legend.text = element_text(size = 14),
    legend.title = element_text(size =18)
  )


(diabplot|levelplot)+
  plot_annotation(
    title = "Распределение пациентов по группам проведения трансплантации",
    theme = theme(plot.title = element_text(hjust = 0.5, size = 28)))
```

Из графика распределения пациентов по статусу диабета видно: у большей доли пациентов исследования не диагностирован диабет. При этом, примерно половине пациентов с диабетом провели трансплантацию, визуально эта доля ниже доли пациентов без диабета, получивших орган. 

Из графика распределения пациентов по расположению медицинского центра видно: примерно равные значения пациентов принадлежат локальным и федеральным медицинским центрам, наблюдается тенденция повышенной вероятности трансплантации почки у пациентов локального центра.

------------------------------------------------------------------------

# 2. Базовые данные по трансплантации

Для первичного анализа трансплантации во времени всех пациентов построили кривую Каплана-Мейера

```{r}
surv_object <- Surv(time = data$Twaiting, event = as.numeric(data$Status_max_numeric))

fit1 <- survfit(surv_object ~ 1, data = data)
```

```{r}
p1 <- ggsurvplot(fit1, 
                 data = data,
                 fun = "event",
                 legend = 'none',
                 conf.int = T)
p1$plot+
  labs(
    title = 'Кривая вероятности трансплантации во времени',
    x = 'Время до трансплантации, дни',
    y  = 'Кумулятивная вероятность трансплантации, %'
  )+
  scale_x_continuous(breaks = seq(0, 3000, 300))+
  scale_y_continuous(breaks = seq(0, 1, 0.1))+
  thememine
```

Наблюдается постоянное увеличение рика трансплантации почки у пациентов во времени. Риск быстро растет до ~1000 дня, затем выходит на плато.

Исходя из полученной функции выживаемости можем сделать следующие выводы о вероятности рансплантации во времени: 


```{r}

per <- c(0.5, 0.8, 0.9)

q1 <- quantile(fit1, per, conf.int = TRUE)


dfq1 <- data_frame(
  'Пациенты \nс трансплантацией, %' = per*100,
  'Время наблюдения, дни' = q1$quantile,
  'Нижняя граница ДИ' = q1$lower,
  'Верхняя граница ДИ' = q1$upper
)

flextable(dfq1) %>% 
  theme_box() %>% 
  bg(part = "header", bg = "cornsilk") %>% 
  align(part = 'all', align = 'center') %>% 
  set_table_properties(layout = 'autofit', width = 1) %>% 
  set_caption('Характеристика вероятнотей трансплантации во времени')
```


Медиана времени до трансплантации составила 324 дня, т.е. 50% пациентов получили почку к 324 дню (~ 11 месяц) постановки на учет необходимости трансплантации, ДИ [308, 343].
80% пациентов получили почку к 1166 дню постановки на учет необходимости трансплантации (~ через 3,2 года), ДИ [1074, 1267].


```{r}
timem <- c(30)

df <- tibble(
  'Время наблюдения, дни' = timem,
  'Вероятность трансплантации' = ((1- summary(fit1, timem)$surv)*100) %>% round(1) ,
  "Нижняя граница ДИ" = ((1 - summary(fit1, timem)$upper)*100) %>% round(1),
  "Верхняя граница ДИ" = ((1 - summary(fit1, timem)$lower)*100) %>% round(1)
)

flextable(df) %>% 
  theme_box() %>% 
  bg(part = "header", bg = "cornsilk") %>% 
  align(part = 'all', align = 'center') %>% 
  set_table_properties(layout = 'autofit', width = 1) %>% 
  set_caption('Характеристика вероятнотей трансплантации во времени в зависимости от дня')
```

К 30 дню наблюдения 8,5% пациентов получили почку, ДИ [7.7, 9.3].

Также исследуем интенсивность трансплантации во времени

```{r fig.width=9, fig.height=3}
life_table <- lifetab2(surv_object ~ 1, data, 
                      breaks = seq(from = 0, to = 2066, by = 180))

life_table_df <- data.frame(
  interval = rownames(life_table), 
  hazard = life_table$hazard, row.names = NULL)

ggplot(life_table_df, aes(x = factor(life_table_df$interval, levels = rownames(life_table)), y = hazard, group = 1)) +
  geom_line(color = "steelblue", size = 1.5, alpha = 0.8) +
  geom_point(color = "steelblue", size = 2, 
             shape = 21, fill = "white", stroke = 1.5) +
  labs(title = "Hazard функция по 180-дневным интервалам",
       x = "Интервал времени", y = "Hazard rate") +
  theme(
        plot.title = element_text(hjust = 0.5, face = "bold"))
```

HR рассчитывали до 2066 дня, т.к. за этот срок у 90% проведена трансплантация почки, после данной точки количества наблюдений значительно снижается и значени HR становятся нестабильными. 

Из графика интенсиности события трансплантации видно, что наибольший риск трансплантации почки наблюдается в первые 6 месяцев. По мере увеличения времени ожидания риск снижается
пересадка проводили к первым 6 месяцам после постановки на учет трансплантации. В поздние сроки интернсивность трансплантации плавно снижалась.

## Анализ подгрупп

## Зависимость времени трансплантации от статуса диабета

Исходя из эксплораторного анализа, мы не наблюдали зависимости времени до проведения трансплантации в зависимости от статуса диабета

```{r}
surv_object <- Surv(time = data$Twaiting, event = as.numeric(data$Status_max_numeric))

fit <- survfit(surv_object ~ diab, data = data)
```

```{r}
p1_2 <- ggsurvplot(fit, 
                 data = data,
                 fun = "event",
                 conf.int = T,
                 pval = T,
                 pval.coord = c(2000, 0.25),
                 palette = c('seagreen', 'steelblue'),
                 legend.title = 'Наличие диабета',
                 legend.labs = diabvalues
                )
  
p1_2$plot+
  # scale_color_manual(
  #   values = diabcolors,
  #   name = 'статус диабета'
  # )+
  labs(
    title = 'Кривая вероятности трансплантации во времени \nв зависимости от статуса диабета',
    x = 'Время до трансплантации, дни'
  )+
  scale_x_continuous(breaks = seq(0, 3000, 300))+
  scale_y_continuous(breaks = seq(0, 1, 0.1))+
  
  thememine 
```

Наблюдается постоянное увеличение рика трансплантации почки у обоих групп пациентов во времени. Риск быстро растет до ~900 дня, затем выходит на плато. Риски трансплантации у двух групп паралельны во времени, при этом риски трансплантации у группы пациентов с диабетом выше, чем у пациентов без дибета.


```{r}
per <- c(0.5, 0.9)

q2 <- quantile(fit, per, conf.int = TRUE)

q2 <-  q2 %>% as.data.frame() 

q2 %>% 
  mutate(
    strata = rownames(q2)) %>%
  pivot_longer(
    cols = -strata,
    names_to = c(".value", "% пациентов"),
    names_sep = "\\."
  ) %>%
  rename( 'Время наблюдения' = 'quantile',
          'Нижняя граница ДИ' = 'lower',
          'Верхняя граница ДИ' = 'upper',
          'Статус' = 'strata') %>% 
  mutate(
    Статус = case_when(
      Статус == 'diab=0' ~ 'Нет диабета',
      Статус == 'diab=1' ~ 'Есть диабет',
      TRUE ~ Статус
    )
  ) %>% 
  as_grouped_data(groups = 'Статус') %>% 
  as_flextable() %>% 
  theme_box() %>% 
  bg(part = "header", bg = "cornsilk") %>%
  bg(i = ~ !is.na(Статус), bg = "grey90", part = "body") %>%
  align(part = 'all', align = 'center') %>% 
  set_table_properties(layout = 'autofit', width = 1) %>% 
  set_caption('Характеристика вероятнотей трансплантации во времени')
  

```

Медианы времени до трансплантации у двух групп различаются: 50% пациентов с диабетом получили почку к 231 дню (ДИ [211, 257]), пациенты без диабета позже - к 359 дню (ДИ [334, 390]).
90% пациентов с диабетом получили почку к 1584 дню (ДИ [1353, 1960]), пациенты без диабета позже - к 2282 дню (ДИ [2040, 2412])

```{r}
timem <- c(30)

df <- tibble(
  'Время наблюдения' = timem,
  strata = summary(fit, timem)$strata,
  "Вероятность трансплантации" = ((1- summary(fit, timem)$surv)*100) %>% round(1),
  "Нижняя граница ДИ" = ((1 - summary(fit, timem)$upper)*100) %>% round(1),
  "Верхняя граница ДИ" = ((1 - summary(fit, timem)$lower)*100) %>% round(1)
) %>% 
  mutate(
    strata = case_when(
      strata == 'diab=0' ~ 'Нет диабета',
      strata == 'diab=1' ~ 'Есть диабет',
      TRUE ~ strata
    )
  ) %>% 
  rename('Статус' = 'strata') %>% 
  as_grouped_data(groups = 'Статус')
  

as_flextable(df) %>% 
  theme_box() %>% 
  bg(part = "header", bg = "cornsilk") %>%
  bg(i = ~ !is.na(Статус), bg = "grey90", part = "body") %>%
  align(part = 'all', align = 'center') %>% 
  set_table_properties(layout = 'autofit', width = 1) %>% 
  set_caption('Таблица - Характеристика вероятнотей трансплантации во времени в зависимости от дня')
```

По сранению с пациентами с диабетом меньший процент пациентов без дибета получит почку к 30 дню наблюдения - 10.5% (ДИ [8.8, 12.2]) и 7.9% (ДИ [7.0, 8.7]) соответственно. 

Также исследуем интенсивность трансплантации во времени пациентов с разным статусом диабета

```{r}
# Разделяем данные по группам
data_diab0 <- data %>% filter(diab == 0)
data_diab1 <- data %>% filter(diab == 1)

# Hazard для пациентов без диабета
hazard_diab0 <- muhaz(data_diab0$Twaiting, as.numeric(data_diab0$Status_max_numeric), 
                     bw.smooth = 365, max.time = 2040)
# Hazard для женщин  
hazard_diab1 <- muhaz(data_diab1$Twaiting, as.numeric(data_diab1$Status_max_numeric), 
                     bw.smooth = 365, max.time = 1353)

# Создаем для пациентов с диабетом
hazard_df <- data.frame(
  time = c(hazard_diab0$est.grid, hazard_diab1$est.grid),
  hazard = c(hazard_diab0$haz.est, hazard_diab1$haz.est),
  diab = rep(c("0", "1"), 
           c(length(hazard_diab0$haz.est), length(hazard_diab1$haz.est))))

ggplot(hazard_df, aes(x = time, y = hazard, color = diab)) +
  geom_line(size = 1.2) +
  labs(title = "Hazard функции по полу (muhaz)",
       x = "Время (дни)", y = "интенсивность риска трнасплантации", color = "Статус диабета")+
  scale_x_continuous(breaks=seq(0,2000,180))+
  scale_color_manual(values = diabcolors,
                     labels = c('0' = 'Нет',
                                '1' = 'Есть')) 
```

HR рассчитывали до 2040 и 1353 дня для пациетов без диабета и с диагнастированным диабетом, т.к. за этот срок у 90% пациентов групп проведена трансплантация почки, после данной точки количества наблюдений значительно снижается и значени HR становятся нестабильными. 

Из графика интенсиности события трансплантации видно, что у пациентов c диабетом исходный риск трансплантации значительно выше риска у группы пациентов без диабета. После 90 дней наблюдения риски обоих групп выравниваются.


# 3. Регрессия Кокса

Расположение медицинского центра может являться конфаундером для взаиомосвязи трансплантации (исхода) и диабета (как воздействия). Социально-экономические причины (экологическая среда, финансируемость, инфраструктура) могут влиять на повышенное количество пациентов с диабетом в центре и разную вероятность трансплантации почки в этом центре.

С помощью регрессии Кокса мы исследовани характер влияния статуса диабета на трансплантацию почки с учетом расположения медицинского центра.

```{r}

cox_modelmine <- coxph(Surv(Twaiting, as.numeric(Status_max_numeric)) ~ diab + Level, 
                   data = data)
```


## Дагностика модели

Модель диагностировали, используя следущие показатели:
Пропорциональность рисков
Мультиколлиреарность

## Анализ пропорциональности рисков

Пропорциональность рисков оценивали визуально с помощью Log-log графиков

```{r}
# Log-log plot через survfit
surv_fit_ <- survfit(Surv(Twaiting, as.numeric(Status_max_numeric)) ~ diab, 
                   data = data)


pl <- ggsurvplot(surv_fit_, 
           data = data,
           fun = "cloglog",
           xlab = "log(дни наблюдения)", 
           ylab = "log(-log(вероятность трансплантации))",
           title = "Log-Log график трасплантации для групп по статусу диабета",
           palette = c('seagreen', 'steelblue'),
                 legend.title = 'Наличие диабета',
                 legend.labs = diabvalues
           )

pl$plot+
  thememine
```
Линии риска выживаемости обеих групп по статусу диабета в целом параллельны.

```{r}
# Log-log plot через survfit
surv_fit_ <- survfit(Surv(Twaiting, as.numeric(Status_max_numeric)) ~ Level, 
                   data = data)

pl2 <- ggsurvplot(surv_fit_, 
           data = data,
           fun = "cloglog",
           xlab = "log(дни наблюдения)", 
           ylab = "log(-log(вероятность трансплантации))",
           title = "Log-Log график трасплантации для разных медицинских центров",
           palette = c('tomato3', 'azure3'),
          legend.title = 'Мед.центр',
          legend.labs = levelvalues
           )

pl2$plot+
  thememine
```

Линии риска выживаемости обеих групп в целом параллельны.


Пропорциональности рисков проверяли также с помощью теста Шенфельда

```{r}
cox_zph <- cox.zph(cox_modelmine)
cox_zph$table %>% 
  data.frame() %>% 
  mutate(
    Variable = rownames(.)
  ) %>% 
  relocate(Variable, .before = 1) %>% 
  flextable()
```

Иходя из полученных значений: для переменной диабета P-value > 0.05, т.е. не выявлено статистически значимых нарушений пропорциональности; для пациентов переменной мед.центра P-value < 0.05, выявлены статистически значимые нарушений пропорциональности. Общая модель имеет P-value < 0.05, т.е. модель в целом  нарушает условие пропорциональности рисков.

Оценим остатки также визуально

```{r}
cox_zph <- cox.zph(cox_modelmine)
ggcoxzph(cox_zph)
```

Для перменной диабета наблюдается примерно пропорциональьный разброс сотатков во времени. Остатки концентрируются вокруг 0.

Для переменной мед центра наблюдается небольшой нисходящий тренд. Остатки не на всем протяжении времени концентрируются у 0


ВЫВОД: Исходя из теста Шенфельда обнаружены статистически значимые наружения пропорциональности, ожнако мы не наблюдаем грубых визуальных нарушений пропорциональности.

## Проверка мультиколлиреарности
```{r}
dd <- datadist(data)
options(datadist = "dd")

cph_model <- cph(Surv(Twaiting, as.numeric(Status_max_numeric)) ~ diab + Level, 
                 data = data, x = TRUE, y = TRUE)

# VIF через rms
vif_results <- vif(cph_model)
print(vif_results) 
```
Полученные значения VIF ~ 1, т.е. мультиколлиреарности наших перменных не наблюдается.

## Оценки модели
```{r}
# Выводим summary модели
summary(cox_modelmine)
```

В модели используется 5888 наблюдений, 3521 из которых случаи с событием (трансплантацией). Модель в 60% случаев правильно описывает наши данные.

Исходя, из модели: пациенты с диабетом имеют риск трансплантации почки в 1,31 (ДИ [1.22, 1.14]) раза выше, чем пациенты без диабета; пациенты локальных центров имеют риск трансплантации почки в 2 (ДИ [1.94, 2.22]) раза выше, чем пациенты федеральных центров. Обе переменные статистически занчимо связаны с временем до трансплантации на уровне значимости 0,05.
