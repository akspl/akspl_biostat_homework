---
title: '**Название исследования**'
author: "Выполнил(и): Оксана Пластинина"
output:
  html_document:
    number_sections: true
    code_folding: hide
    toc: true
    toc_float: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
```

```{r}
library(readxl)
library(tidyverse)
library(gtsummary)
library(ggplot2)
library(patchwork)
library(ggmosaic)
library(flextable)
library(ggResidpanel)
library(ggfortify)
```

```{r}
data <- read_excel("data/raw/HW_data.xlsx")
dictionary <- read_excel("data/raw/HW_dictionary.xlsx")
```

```{r}
thememine <- theme(
  plot.title = element_text(size = 15, hjust = 0.5),
  axis.title = element_text(size = 12),
  axis.text = element_text(size = 9, colour = 'grey10'),
  panel.background = element_rect(fill = 'white'),
  panel.grid = element_line(colour = 'grey90')
)

theme_set(thememine)
```

```{r echo=FALSE}
#dtotord? adequacy? 

datan <- data %>% 
  mutate(across(c(mrace3, dmar, dmeduc3, dtotord, dlivord, medrisk, tobacco, alcohol, pldel, delmeth, csex, labor, newborn, congenit, death,  adequacy), as.factor))

```

<br>

# **Постановка задачи**

Поставлена задача изучить влияние курения матери на два исхода: 
- количественный (изменение среднего значения веса ребенка)
- бинарный (изменение вероятности развития осложнений)

Мы хотим измерить всю совокупность последствий курения: как прямого воздействия на исходы, так и всех возможных косвенных эффектов, проходящих через другие переменные. Например, курение может напрямую снижать вес плода, а также может влиять на него косвенно, повышая риск осложнений, которые, в свою очередь, тоже влияют на вес.С помощью DAG мы сможем оценить струкутуру данных.

Хотя вред курения во время беременности широко известен, цель этого исследования — не просто подтвердить его наличие, а точно измерить величину этого эффекта в конкретной выборке. Это может быть полезно для информирования беременных женщин и их семей с использованием конкретных цифр.

Задание 2.

Т.к. наша цель состоит в понимании влияния курения на исходы беременности и формулирование причинно-следственных связей нам не достаточно просто предсказывать опредленный количественный или вероятностный исход, а нужно понимать вклад определенных внешних факторов. Поэтому каузальная модель, учитывающая роль переменных в исследовании (конфаундеров, медиаторов и коллайдеров), позволяет оценить влияния именно нашей переменной (курения) на выбранные исходы беременности.

Оценку эффектов могут искажать следующие ошибки:
- confounding. При упущении конфаундера, например, генетическая предрасположенность или переживание травматического события во время беременности, могут повлиять на статус курения и наши исходы; 
- selection bias. Может иметь место в следующих случаях: не включение в исследование случаев с разным сроком рождения ребенка;
- information bias. Может иметь место в следующих случаях: женщины врали относительно своего статуса курильщика; в рамках исследования не оценивали частоту курения (у нас есть такая переменная); система оценки осложений разнилась у врачей/исследовательских центров.

Перечисленные ошибки повлияют на индентичность сравниваемых групп и соответсвенно на корректность сформулированных причинно-следственных связей. Перчисленные недочеты можно решить на этапе дизайна за счет включения конфаундеров и строгого регламентирования групп и методов оценки переменных.

На стадии анализа данных мы можем провести стратификацию по конфаундерам, однако, ошибки в оценке переменных и неполноте данных скорректировать на этом этапе нельзя. 

Курение матери во время беременности может приводить как к пониженному весу ребенка при рождении [1,2].

Курение матери во время беременности может приводить к преждевременным родам, гибели ребенка до или во время родов [1,2].

# **Материалы и методы**

# Модель 1 

## Анализ конечной точки 1 модели

Для первичной конечной точки оценивается линейная регрессия методом наименьших квардратов. Для контроля смешивающих факторов использовали модель множественной линейной регресии с включением ковариат, отобранных с помощью каузального графа.

С помощью каузального графа определили следующие роли переменных:
Воздействие - курения матери во время беременности
Исход - вес при рождении
Конфаундеры, влияющие напрямую - возраст, раса, образование матери, употребление алкоголя матерью, пренатальный уход
Конфаундеры, которые напрямую не влияют на воздействие и/или исход - медицинские риски (напрямую влияет только на исход, через пренатальный уход влияет на воздействие)
Конкурирующее воздействие на исход - пол ребенка
Коллайдеры - смерть ребенка и осложнения при родах
Нейтральные, влияющие на исход - пол ребенка, номер беременности
Нейтральные переменные - тип родов

## DAG и отбор ковариат модели

DAGitty предлагает минимально достаточный набор конфаунлеров для оценки прямого влияния курения матери на массу ребенка при рождении: Возраст матери, Употребление алкоголя матерью, Образование матери, Расовая принадлежность матери, Пренатальный уход

Но мы можем также включить в модель дополнительно конфаундер - медицинские риски, который через медиатор пренатальный уход влияет на воздействие и напрямую - на исход. 

Медиатор, коллайдеры и нейтральные переменные - не включаем, чтобы не допустить смещение и не перегружать модель

```{r}
DAG1 <- readxl::read_excel("DAG1.xlsx")

DAG1
```

### Другие возможные конфаундеры, которые не представлены в данном графе?

Предполагаем, что исследователь не представил на графе в качестве конфаундера переменную "Marital status of mother".

Предполагаем, что данный параметр может быть конфаундером, т.к. условия жизни матери во время беременности, а именно отсутствие семьи, может спровоцировать курение матери, что влияет и на осложнения при родах.

Предполагаем, что включение этого конфаундера в модель незначительно повлияет на результат работы модели, поэтому не включено в даг. 

Помимо данных, представленных в датасете, конфаудерами могли бы быть:

- Условия жизни матери во время беременности,
- Уровень стресса во время беременности,
- Сопутствующие заболевания матери,
- Доход матери.

## Измерение ключевых показателей:

Измерение курения матери во время беременности - 
Вес ребенка - средний вес ребенка при рождении (кол.пер)
Ковариаты в модели: 
Возраст матери - средний возраст в годах (кол.пер.)
Образование матери - 17 категорий (кат.пер.)
Расовая принадлежность матери -  (кат.пер.)
Пренатальный уход - Адекватность дородового ухода (кат.пер.)
Употребление алкоголя матерью 

Диагностику линейности модели проводили с использованием визуальных методов путем построения графиков отношения остатков и предсказанных знаений и остатков и отдельных предикторов.

# Модель 2

## Анализ конечной точки 2 модели

Воздействие - курения матери во время беременности, 

Исход - осложнения во время родов

Конфаундеры, влияющие напрямую - употребление алкоголя матерью, возраст матери

Конфаундеры, которые напрямую не влияют на воздействие и/или исход - раса матери, образование матери, медицинские риски, пренатальный уход
Медиаторы - вес ребенка
Нейтральные, влияющие на исход - пол ребенка, кол-во предыдущих родов и метод родов 
Нейтральные переменные - младенческая смерть

## DAG и отбор ковариат модели

DAGitty предлагает целых 5 вариантов минимально достаточных групп конфаундеров для оценки прямого влияния курения матери на вероятность возникновения осложнений при родах

Тип родов, медицинские риски, возраст матери, употребление алкоголя матерью

Медицинские риски, возраст, образование, раса матери, употребление алкоголя матерью

Медицинские риски, возраст матери, употребление алкоголя матерью, количество предыдущих родов

Возраст матери, употребление алкоголя матерью, образование матери, раса матери, дородовой уход

Возраст матери, употребление алкоголя матерью, количество предыдущих родов, дородовой уход

Считаем, что в итоговую модель стоит включить прямые конфаундеры - употребление алкоголя матерью и возраст матери. А также остальные конфаундеры, которые имеют большее отношение именно к родам - медицинские риски, пренатальный уход, а также раса и образование матери. Нейтральные переменные - не включаем

DAGitty предлагает не все конфаундеры одновременно, или предлагает добавить в модель медиаторы, возможно, так как переменные так же связаны друг с другом каузальными связями

```{r}
DAG2 <- readxl::read_excel("DAG2.xlsx")

DAG2
```

### Другие возможные конфаундеры, которые не представлены в данном графе?

Предполагаем, что исследователь не представил на графе в качестве конфаундера переменную "Marital status of mother".

Предполагаем, что данный параметр может быть конфаундером, т.к. условия жизни матери во время беременности, а именно отсутствие семьи, может спровоцировать курение матери, что влияет и на вес новорожденного.

Предполагаем, что включение этого конфаундера в модель незначительно повлияет на результат работы модели, поэтому не включено в даг. 

Помимо данных, представленных в датасете, конфаудерами могли бы быть:
- Условия жизни матери во время беременности,
- Уровень стресса во время беременности,
- Сопутствующие заболевания матери.

## Измерение ключевых показателей:

Измерение курения матери во время беременности - 
Осложнения во время родов 
Ковариаты в модели: 
Употребление алкоголя матерью
Возраст матери 
Образование матери
Расовая принадлежность матери
Пренатальный уход



## **Дизайн исследования**

Данное исследование представляет собой кросс-секционное (поперечное) исследование, основанное на анализе собранных данных о беременности и родах. В исследовании приняли участие 537 женщин, данные о которых были получены из медицинской документации и опросников. Особенностью данного дизайна является то, что все переменные измерялись одновременно, в период родоразрешения, что позволяет оценить существующие ассоциации между изучаемыми факторами, но не устанавливать временную последовательность событий. Для повышения валидности получаемых результатов в данном исследовании применяются методы статистического контроля конфаундинга на основе предварительно построенного причинно-следственного графа (DAG), что позволяет минимизировать смещение оценок и более обоснованно интерпретировать обнаруженные ассоциации.

## **Конечные точки**

Модель 1: Влияние курения на вес при рождении
Конечная точка:
Переменная: dbirwt (вес при рождении в граммах)
Тип: Непрерывная количественная переменная
Параметр оценки: Средняя разница веса (β-коэффициент)
Метод анализа: Множественная линейная регрессия

Модель 2: Влияние курения на вероятность осложнений при родах
Конечная точка:
Переменная: labor (осложнения во время родов)
Тип: Бинарная переменная (0 = нет осложнений, 1 = есть осложнения)
Параметр оценки: Отношение шансов (OR - Odds Ratio)
Метод анализа: Логистическая регрессия

## **Описательные статистики**

Для описания исходных данных использовались следующие описательные статистики:
Для непрерывных переменных:
-Среднее значение и стандартное отклонение
-Медиана
-Минимум и максимум
-Визуализация распределения с помощью гистограмм и боксплотов. 
Для категориальных переменных:
-Абсолютные частоты (n)
-Относительные частоты (%)
-Визуализация с помощью столбчатых диаграмм


## **Анализ дополнительных конечных точек**

...

<br>

# **Результаты**

## **Описательная статистика и эксплораторный анализ**

```{r}
variable_dict <- setNames(dictionary$label, dictionary$variable)

categorical_table <- data %>%
  select(labor, tobacco, alcohol, medrisk, death, mrace3, dmeduc3, adequacy, delmeth, csex, drink) %>%
  mutate(across(c(labor, tobacco, alcohol, medrisk, death), 
                ~factor(., levels = c("0", "1"), labels = c("No", "Yes")))) %>%
  rename_with(~ variable_dict[.x], .cols = any_of(names(variable_dict))) %>% 
  tbl_summary(
    type = all_categorical() ~ "categorical",
    statistic = all_categorical() ~ "{n} ({p}%)",
    missing_text = "Missing"
  ) %>%
  modify_header(label = "**Категориальные переменные**") %>%
  modify_caption("**Таблица 1A. Категориальные переменные**")

continuous_table <- data %>%
  select(dmage, dbirwt, dtotord, dmeduc, monpre, nprevist, gestat, cigar) %>%
  rename_with(~ variable_dict[.x], .cols = any_of(names(variable_dict))) %>% 
  tbl_summary(
    type = all_continuous() ~ "continuous2",
    statistic = all_continuous() ~ c("{mean} ({sd})", "{median}", "{min}, {max}"),
    digits = all_continuous() ~ 2,
    missing_text = "Missing"
  ) %>%
  modify_header(
    label = "**Числовые переменные**",
    stat_0_1 = "**Mean (SD)**",
    stat_0_2 = "**Median**", 
    stat_0_3 = "**Min, Max**"
  ) %>%
  modify_caption("**Таблица 1B. Числовые переменные**")


```

```{r}
plot_continuous_dist <- function(data, var, var_name, color) {
  ggplot(data, aes(x = {{var}})) +
    geom_histogram(bins = 20, fill = color, alpha = 0.7, color = "white") +
    geom_vline(aes(xintercept = median({{var}}, na.rm = TRUE)), 
               color = "red", linetype = "dashed", size = 1) +
    labs(title = paste("Распределение:", var_name),
         x = var_name, y = "Частота") +
    theme_minimal() +
    theme(plot.title = element_text(size = 11))
}

plot_boxplot <- function(data, var, var_name, color) {
  ggplot(data, aes(y = {{var}})) +
    geom_boxplot(fill = color, alpha = 0.7, outlier.color = "red", outlier.size = 2) +
    labs(title = paste("Выбросы:", var_name),
         y = var_name) +
    theme_minimal() +
    theme(plot.title = element_text(size = 11))
}

plot_categorical <- function(data, var, var_name, color) {
  data %>%
    count({{var}}) %>%
    mutate(prop = n/sum(n),
           category = as.character({{var}})) %>%
    ggplot(aes(x = reorder(category, prop), y = prop)) +
    geom_col(fill = color) +
    coord_flip() +
    labs(title = paste("Распределение:", var_name),
         x = "", y = "Доля") +
    scale_y_continuous(labels = scales::percent) +
    theme_minimal() +
    theme(plot.title = element_text(size = 11))
  
  
}

plot_by_smoking <- function(data, var, var_name, color_palette = c("lightgreen", "coral")) {
  ggplot(data, aes(x = factor(tobacco), y = {{var}}, fill = factor(tobacco))) +
    geom_boxplot(alpha = 0.7) +
    labs(title = paste(var_name, "по статусу курения"),
         x = "Курение во время беременности", 
         y = var_name) +
    scale_x_discrete(labels = c("Не курит", "Курит")) +
    scale_fill_manual(values = color_palette, guide = "none") +
    theme_minimal() +
    theme(plot.title = element_text(size = 11))

}

p1 <- plot_continuous_dist(data, dbirwt, "Вес при рождении", "steelblue")
p2 <- plot_boxplot(data, dbirwt, "Вес при рождении", "lightblue")
p3 <- plot_continuous_dist(data, dmage, "Возраст матери", "darkgreen")
p4 <- plot_boxplot(data, dmage, "Возраст матери", "lightgreen")

(p1 + p2) / (p3 + p4) +
  plot_annotation(title = "Эксплораторный анализ: непрерывные переменные",
                  theme = theme(plot.title = element_text(size = 16, face = "bold")))

```

```{r fig.width=18, fig.height=10}
  categorical_plots <- (
    plot_categorical(data, tobacco, "Курение", "brown") +
    plot_categorical(data, dmeduc3, "Образование", "pink") +
    plot_categorical(data, mrace3, "Раса", "coral") +
    plot_categorical(data, adequacy, "Пренат. уход", "lightblue") +
    plot_categorical(data, alcohol, "Алкоголь", "darkblue") +
    plot_categorical(data, labor, "Осложнения", "darkgreen")
  ) + plot_layout(nrow=2, ncol = 3)


categorical_plots
```


```{r}
p5 <- plot_by_smoking(data, dbirwt, "Вес при рождении")
p6 <- plot_by_smoking(data, dmage, "Возраст матери")

p7 <- data %>%
  ggplot() +
  geom_mosaic(aes(x = product(tobacco), fill = labor))+
  labs(title = "Статус осложнений по статусу курения",
       x = "Курение", y = "Осложнение") +
  scale_fill_viridis_d() +
  theme_minimal() +
  theme(plot.title = element_text(size = 11))

p8 <- data %>%
  ggplot() +
  geom_mosaic(aes(x = product(tobacco), fill = adequacy)) +
  labs(title = "Пренатальный уход  по статусу курения",
       x = "Курение", y = "Уход") +
  scale_fill_viridis_d() +
  theme_minimal() +
  theme(plot.title = element_text(size = 11))

(p5 + p6) / (p7 + p8) +
  plot_annotation(title = "Сравнение характеристик по статусу курения",
                  theme = theme(plot.title = element_text(size = 16, face = "bold")))

```

```{r}
additionaltable_cath <- data %>% 
  select(death, congenit, newborn) %>% 
  mutate(across(c(death, congenit, newborn), 
                ~factor(., levels = c("0", "1"), labels = c("No", "Yes")))) %>%
  rename_with(~ variable_dict[.x], .cols = any_of(names(variable_dict))) %>% 
  tbl_summary(
    type = all_categorical() ~ "categorical",
    statistic = all_categorical() ~ "{n} ({p}%)",
    missing_text = "Missing"
  ) %>%
  modify_header(label = "**Категориальные переменные**") %>%
  modify_caption("**Таблица 2A. Дополнительные конечные точки: Категориальные переменные**")




additionaltable_col <- data %>% 
  select(gestat) %>%
  rename_with(~ variable_dict[.x], .cols = any_of(names(variable_dict))) %>% 
  tbl_summary(
    type = all_continuous() ~ "continuous2",
    statistic = all_continuous() ~ c("{mean} ({sd})", "{median}", "{min}, {max}"),
    digits = all_continuous() ~ 2,
    missing_text = "Missing"
  ) %>%
  modify_header(
    label = "**Числовые переменные**",
    stat_0_1 = "**Mean (SD)**",
    stat_0_2 = "**Median**", 
    stat_0_3 = "**Min, Max**"
  ) %>%
  modify_caption("**Таблица 2B. Дополнительные конечные точки: Числовые переменные**")

additionaltable_cath
additionaltable_col
```


```{r fig.height=5, fig.width=12}
p9 <- plot_by_smoking(data, gestat, "Количество недель беременности")

p10 <- data %>% 
    mutate(across(c(tobacco, newborn), 
                ~factor(., levels = c("0", "1"), labels = c("No", "Yes")))) %>% 
  ggplot()+
  geom_mosaic(aes(x = product(tobacco), fill = newborn))+
  labs(title = "Статус наличия ненормальных состояний при рождении",
       x = "Курение", y = "Наличие ненормальных состояний") +
  scale_fill_viridis_d() +
  theme_minimal() +
  theme(plot.title = element_text(size = 11))

(p9 + p10) +
  plot_annotation(title = "Сравнение характеристик по статусу курения",
                  theme = theme(plot.title = element_text(size = 16, face = "bold")))
```


## **Результаты эксплораторного анализа конечной точки 1**

Средний вес новорожденных составил 3366.58 грамм при стандартном отклонении 573.59 грамм, что свидетельствует о существенном разбросе значений вокруг среднего. Медианное значение веса (3402.00 грамм) несколько превышает среднее арифметическое, что указывать на легкую левостороннюю асимметрию распределения, что подтвкерждает визуализация (Приложение 2).

Диапазон значений веса при рождении варьировал от 1134.00 грамм до 4876.00 грамм, что отражает значительную вариабельность изучаемого показателя в выборке. Наличие случаев с экстремально низким весом (1134 г) может быть связано с недоношенностью, задержкой внутриутробного развития или другими патологическими состояниями, в то время как максимальные значения приближаются к верхней границе нормального веса доношенных новорожденных.

Сравнение среднего значения с общепопуляционными нормами (обычно 2500-4000 г для доношенных детей) показывает, что исследуемая выборка в целом соответствует ожидаемым параметрам, однако наличие случаев как с очень низким, так и с высоким весом требует дополнительного анализа потенциальных факторов, влияющих на этот показатель.

Размер стандартного отклонения (около 17% от среднего значения) указывает на умеренную вариабельность веса при рождении в изучаемой популяции, что является типичным для данного антропометрического показателя.

## Результаты анализа конечной точки 1


```{r}
fit1 <- lm(data$dbirwt ~ data$cigar, data)

fit1
```

При построении графика зависимости остатков от значений, предскасказанных на основе линейной модели без учета смешивающих факторов, наблюдается нарушение усливий линейной регресиии: нелинейный разброс остатков относительно 0, их разброс увеличивается с ростом предсказанных значений, после границы веса ребенка в 3200 г модель системалически завышает предсказанные значения (Приложение 3А). 


Для линеризации взаимосвязи проведем логарифмирование перменной cigar.

```{r}
fit11 <- lm(data$dbirwt ~ log(data$cigar+1), data)
fit11
```

Логарифмирование позволило линеризовать и уменьшить разброс остатков до диапазона -2000 - 1000 (Приложение 3Б). Данные все ещё сильно вариабельны, наибольший разброс остатков сконцентрирован при предсказании значений в районей 3400.

Исходя из графиков диагностики модели (Прилоджение 3В) можно сделать следующие выводы: 
1) остски распредлены ненормально, наблюдаются значительные отклонения в распределении их нижней области 
2) стандартные ошибки распределены примерно равномерно
3) влиятельных наблюдений не наблюдается, все точки находятся внутри линий расстояний Кука.

Согласно данной модели, средний вес новорожденного у неккрящий матерей 3409 г. 

```{r}
fit2 <- lm(data$dbirwt ~ data$cigar + data$drink + data$dmage + data$medrisk + data$adequacy + data$mrace3 + data$dmeduc3, data)

fit2
```

Построение линейной модели с учетом смешивающих факторов позволяет исключить нелинейный разброс остатков относительно 0 (см. график зависимости остатков от предсказанных значений из приложения 4)

Исходя из графков диагностики линейной модели (Приложение 3Б) можно сделать слеующие выводы:

1) График Residuals vs Fitted строит горизонтальную прямую, свидетельствующую о линйеной взаимосвязи пременных.

2) график Scale-location имеет горизонтальную линию с некоторым отклоением с области значений больишх 3300

2) QQ-plot свидетельствует о ненормальности распределения остатков.


Согласно данной модели средний вес ребенка у некурящих матерей 3274 г, а выкуривание одной сигареты связано с уменьшением веса ребенка на 13.5 г.

## **Результаты эксплораторного анализа конечной точки 2**

Распределение осложнений во время родов и/или родоразрешения в исследуемой выборке показывает следующую картину:

В общей сложности осложнения были зарегистрированы у 176 женщин (33%) из 537 наблюдений (Приложение 1). Это означает, что примерно каждая третья женщина в исследовании столкнулась с теми или иными осложнениями в процессе родов.

Большинство родов (67%) прошли без осложнений - такая картина наблюдалась у 361 женщины. Полученное соотношение 2:1 (два случая неосложненных родов на один случай с осложнениями) указывает на то, что хотя осложнения являются частым явлением, нормальное течение родов все же преобладает в изучаемой популяции.

## **Результаты анализа дополнительных конечных точек**

...

В качестве дополнительных конечных точек рассматривали смерть ребенка при рождении, наличие любых ненормальных состояний при рождении, наличие любых врожденных аномалий и количество недель беременности.
Анализ влияния курения на смерть ребенка при рождении и наличие любых врожденных аномалий не проводили, т.к для этих характеристик в исследовании зарегистрирован один и 0 случаев соответственно.

Среднее значение недели родов (39 недель со страндартным отклонением 2.4) соответсвует нормальным срокам родоразрешения. Неделя, на которой происходили роды варьировал от 28 до 47 недель. При этом количество женщин, родивших раньше 35 недели больше в группе не курящих женщин.

Ненормлаьные состояния после рождения зарегистрированы только в 6,3 % случаев в больншинстве у не курящих женщин.

...

<br>

# **Ограничения**

...

<br>

# **Выводы**

...

<br>

# **Источники литературы**

1. Delcroix M.-H., Delcroix-Gomez C., Marquet P., Gauthier T., Thomas D., Aubard Y. Active or passive maternal smoking increases the risk of low birth weight or preterm delivery: Benefits of cessation and tobacco control policies//Tobacco Induced Diseases, 2023, Vol. 21, Active or passive maternal smoking increases the risk of low birth weight or preterm delivery, No. May, P. 1-13.

2. Hamadneh S., Hamadneh J. Active and Passive Maternal Smoking During Pregnancy and Birth Outcomes: A Study From a Developing Country//Annals of Global Health, 2021, Vol. 87, Active and Passive Maternal Smoking During Pregnancy and Birth Outcomes, No. 1.
...

<br>

# **Использование ИИ**

...

<br>

# **Приложения**

## **Приложение 1**

```{r}

categorical_table

```

<br>

## **Приложение 2**

```{r}
continuous_table
```

<br>

## **Приложение 3А**

```{r}
resid_panel(fit1, plots = "resid", smoother = TRUE)
```

## **Приложение 3Б**
```{r}
resid_panel(fit11, plots = "resid", smoother = TRUE)
```

## **Приложение 3В**
```{r}
autoplot(fit11)
```

## **Приложение 4**

```{r}
resid_panel(fit2, plots = "resid", smoother = TRUE)
```

## **Приложение 5**
```{r}
resid_xpanel(fit2, smoother = TRUE)
```

